<div class="container">
  <div class="project-container">
    <div class="header-group">
      <mat-form-field class="selector">
        <mat-label>Виберіть проект</mat-label>
        <mat-select
          [value]="currentProject()"
          (valueChange)="onSelectChange($event)"
        >
          @for (project of projects(); track project) {
          <mat-option [value]="project._id">{{ project.name }}</mat-option>
          }
          <mat-option value="all">Усі</mat-option>
        </mat-select>
      </mat-form-field>
      <div class="btn-wrapper">
        <button mat-raised-button color="primary" [routerLink]="['create']">
          + Нове завдання
        </button>
      </div>
    </div>

    <ng-container *ngIf="assignments().length; else empty">
      <table mat-table [dataSource]="assignments()" class="mat-elevation-z8">
        <ng-container matColumnDef="projectName">
          <th mat-header-cell *matHeaderCellDef>Проект</th>
          <td mat-cell *matCellDef="let assignment" class="projectName-value">
            {{ assignment.project.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Назва</th>
          <td mat-cell *matCellDef="let assignment">
            {{ assignment.name }}
          </td>
        </ng-container>

        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Опис</th>
          <td mat-cell *matCellDef="let assignment" class="description-value">
            {{ assignment.description }}
          </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Статус</th>
          <td mat-cell *matCellDef="let assignment">
            <div>{{ status[assignment.status] }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="priority">
          <th mat-header-cell *matHeaderCellDef>Пріоритет</th>
          <td mat-cell *matCellDef="let assignment">
            <div>{{ priority[assignment.priority] }}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="assignee">
          <th mat-header-cell *matHeaderCellDef>Виконавець</th>
          <td mat-cell *matCellDef="let assignment">
            {{ assignment.assignee?.firstName }}
            {{ assignment.assignee?.secondName }}
          </td>
        </ng-container>

        <ng-container matColumnDef="deadline">
          <th mat-header-cell *matHeaderCellDef>Дедлайн</th>
          <td mat-cell *matCellDef="let assignment">
            {{ assignment.deadline | date : "dd.MM.yyyy" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Дії</th>
          <td mat-cell *matCellDef="let assignment">
            <button
              mat-flat-button
              color="accent"
              [routerLink]="['edit', assignment._id]"
            >
              Редагувати
            </button>
            |
            <button
              mat-flat-button
              color="warn"
              (click)="onDelete(assignment._id, $event)"
            >
              Видалити
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr
          class="table-row"
          (click)="onItemClick(assignment)"
          mat-row
          *matRowDef="let assignment; columns: displayedColumns"
        ></tr>
      </table>
    </ng-container>
  </div>
</div>

<ng-template #empty>
  <div class="empty">Здається тут нічого немає...</div></ng-template
>
